<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Bitcoin Payment ‚Äì CPN Creator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #000;
      color: #fff;
      padding: 40px;
      max-width: 700px;
      margin: auto;
    }
    h1 { font-size: 2em; }
    .price-line {
      display: flex;
      align-items: center;
      gap: 15px;
      font-size: 1.4em;
      font-weight: bold;
      margin: 15px 0;
    }
    #btcAmount { color: orange; cursor: pointer; }
    .btc-section {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 20px;
      margin: 15px 0;
    }
    .btc-address {
      background: #222;
      padding: 14px 18px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 1.25em;
      font-weight: bold;
    }
    #qrcode img { width: 120px; height: 120px; }
    label { display: block; margin-top: 20px; font-weight: bold; }
    input, select, button {
      display: block;
      width: 100%;
      box-sizing: border-box;
      padding: 12px;
      margin-top: 8px;
      border-radius: 4px;
      border: none;
      font-size: 1em;
    }
    button {
      background: linear-gradient(90deg, #28a745, #218838);
      color: white;
      font-size: 1.2em;
      margin-top: 20px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    button:hover {
      background: #1e7e34;
      transform: scale(1.03);
    }
    #confirmation, #timerBox {
      display: none;
      margin-top: 30px;
      background: #e0ffe0;
      padding: 30px;
      border-left: 6px solid green;
      font-size: 1.1em;
      color: #000;
    }
    #notice { color: red; font-weight: bold; }
    progress {
      width: 100%;
      height: 30px;
      margin-top: 15px;
    }
    #downloadLink { display: none; margin-top: 20px; text-align: center; }
    #thankYouMessage {
      display: none;
      margin-top: 30px;
      font-size: 1.2em;
      line-height: 1.4;
      text-align: center;
    }
    a, a:visited, a:hover, a:active { color: #fff; text-decoration: none; }
  </style>
</head>
<body>

  <div style="background: #111827; padding: 20px 25px; border-radius: 12px; margin-bottom: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.4);">
  <h3 style="color: #38bdf8; margin-bottom: 12px; font-size: 1.3rem;">üîé What You Get:</h3>
  <ul style="list-style: none; padding-left: 0; line-height: 1.8; font-size: 1.05rem;">
    <li>‚úÖ <strong>AI-Powered CPN Generator</strong> ‚Äì Built on SSA validation logic</li>
    <li>üîê <strong>Reused Number Scanner</strong> ‚Äì Flagged CPN protection included</li>
    <li>üñ•Ô∏è <strong>Offline License (Device-Locked)</strong> ‚Äì One-time activation, no server needed</li>
    <li>‚ôªÔ∏è <strong>Lifetime Updates + Priority Support</strong> ‚Äì Always up to date</li>
  </ul>
</div>

<p style="color: #16a34a; font-size: 0.95rem; text-align: center; margin-bottom: 20px;">üéâ Trusted by 100+ users ‚Äî Last confirmed order: <span id="recentTime">2 minutes ago</span></p>

<div class="price-line" style="margin-top: 10px;">
  <span>Price: <span style="color: #00ff00;">$700</span></span>
  <span id="btcAmount">‚âà Loading BTC...</span>
</div>

<p id="notice" style="color: #f87171; font-weight: bold;">
  Please send the exact amount shown above.
</p>

<div class="btc-section">
  <div class="btc-address" onclick="copyBTC()" title="Click to copy">
    bc1qtfxzerwdm0wv6v7akvx0h0ksqvx7ycuhaxqa5y
  </div>
  <p style="margin-top: 10px; font-size: 0.9em; color: #9ca3af;">
    üìã Click address to copy
  </p>
  <div id="qrcode">
    <img src="https://raw.githubusercontent.com/cpncreator/cpncreator.github.io/main/assets/qrcode.png" alt="QR Code">
  </div>
</div>

<div id="orderPopup" style="
  position: fixed;
  left: 30px;
  top: 50%;
  transform: translateY(-50%);
  background: #1f2937;
  color: #10b981;
  padding: 14px 20px;
  border-radius: 10px;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  font-size: 0.95rem;
  font-weight: 500;
  display: none;
  z-index: 9999;
  transition: opacity 1s ease;
">
  ‚úÖ Last confirmed order: <span id="randomMinutes">2</span> minutes ago
</div>
<div id="paymentSection">
  <form id="paymentForm">
    <label for="email">Your Email</label>
    <input type="email" id="email" required>

    <label for="os">Windows or Mac Version?</label>
    <select id="os" required>
      <option value="">Select...</option>
      <option value="Windows">Windows</option>
      <option value="Mac">Mac</option>
    </select>

    <label for="txid">Transaction ID</label>
    <input type="text" id="txid" required>

    <button type="submit">Submit</button>
  </form>
</div>

  <div id="confirmation">
  <p><strong>‚úÖ Payment submission received!</strong></p>
  <p>We're tracking your BTC confirmation now. Once it hits 6 confirmations, your download will unlock automatically.</p>
  <p>Need help or have questions? Contact us anytime:</p>
  <p>Email ‚Äì <strong>Coding-planet@proton.me</strong> | WhatsApp ‚Äì <strong>(818) 617-6711</strong></p>
</div>

  <div id="timerBox">
    <p style="font-size: 1.3em; font-weight: bold;">‚è≥ Close this page after confirmation is completed!</p>
    <progress id="progressBar" value="0" max="6"></progress>
  </div>

  <div id="downloadLink"></div>
  <div id="thankYouMessage">
    Your download has started. If you have any questions or did not get your download, you can send us a message on the following.
<p>Email - <strong>Coding-planet@proton.me</strong> | Whatsapp ONLY - <strong>(818) 617-6711</strong></p>
  </div>

  <script>
  const apiToken = '68cd7b8dcabf4598941296b9f1e09b34';
  const callMeBotApiKey = '1474937';
  const callMeBotPhone = '18186176711';

  let confirmationInterval;
  let userEmail = '';
  let userOS = '';
  let userTxid = '';
  const downloadLinkDiv = document.getElementById('downloadLink');
  const thankYouDiv = document.getElementById('thankYouMessage');

  function fetchBTCPrice() {
  fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd')
    .then(res => res.json())
    .then(data => {
      const usdRate = data.bitcoin.usd;            // e.g. 57000
      const btcAmount = (700 / usdRate).toFixed(8); // your $700 price
      document.getElementById('btcAmount').textContent = `‚âà ${btcAmount} BTC`;
    })
    .catch(err => {
      console.error('BTC price fetch error:', err);
      document.getElementById('btcAmount').textContent = '‚ö†Ô∏è Error loading BTC';
    });
}

  function copyBTC() {
    navigator.clipboard.writeText('bc1qtfxzerwdm0wv6v7akvx0h0ksqvx7ycuhaxqa5y')
      .then(() => alert("Bitcoin address copied to clipboard."));
  }

  function generateRandomString(length) {
    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
    return Array.from({ length }, () => chars.charAt(Math.floor(Math.random() * chars.length))).join('');
  }

  async function downloadFile(url, filename) {
    const response = await fetch(url);
    const blob = await response.blob();
    const blobUrl = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = blobUrl;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(blobUrl);
  }

  function sendWhatsAppMessage(message) {
    const url = `https://api.callmebot.com/whatsapp.php?phone=${callMeBotPhone}&text=${encodeURIComponent(message)}&apikey=${callMeBotApiKey}`;
    fetch(url)
      .then(res => res.text())
      .then(data => console.log('WhatsApp sent:', data))
      .catch(err => console.error('WhatsApp error:', err));
  }

  function checkConfirmations(txid) {
    fetch(`https://api.blockcypher.com/v1/btc/main/txs/${txid}?token=${apiToken}`)
      .then(res => res.json())
      .then(data => {
        const confirms = data.confirmations || 0;
        document.getElementById('progressBar').value = confirms;

        if (confirms >= 6) {
          clearInterval(confirmationInterval);
          const randomSuffix = generateRandomString(8);
          const baseURL = userOS === 'Windows'
            ? 'https://mega.nz/file/6KBxzDpD#dQKkd4JFzgWXbaIcMNARPnmSxf-WrsEpjuL3yQz3JxI'
            : 'https://mega.nz/file/GewSzRBS#_D3tjDhH3-QbmkIjbBP23Q5FXexkRHHa_vsLi-QaJBk';
          const finalURL = `${baseURL}?id=${randomSuffix}`;

          downloadLinkDiv.style.display = 'block';
          downloadLinkDiv.innerHTML = `<button id="downloadBtn">üü¢ Download CPN Creator</button>`;
          const dlBtn = document.getElementById('downloadBtn');

          dlBtn.addEventListener('click', async () => {
            dlBtn.disabled = true;
            await downloadFile(finalURL, 'CPN_Creator.zip');
            document.getElementById('paymentSection')?.style.display = 'none';
            document.getElementById('confirmation').style.display = 'none';
            document.getElementById('timerBox').style.display = 'none';
            downloadLinkDiv.style.display = 'none';
            thankYouDiv.style.display = 'block';
          });

          dlBtn.addEventListener('contextmenu', e => e.preventDefault());

          const confirmationMsg = `‚úÖ BTC confirmed!\nEmail: ${userEmail}\nTXID: ${userTxid}`;
          sendWhatsAppMessage(confirmationMsg);

          fetch('https://formspree.io/f/xvgaawzj', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Accept': 'application/json'
            },
            body: JSON.stringify({
              email: userEmail,
              message: `New BTC Submission\nEmail: ${userEmail}\nTXID: ${userTxid}`
            })
          });
        }
      });
  }

  document.getElementById('paymentForm').addEventListener('submit', function (e) {
    e.preventDefault();
    userEmail = document.getElementById('email').value.trim();
    userOS = document.getElementById('os').value;
    userTxid = document.getElementById('txid').value.trim();

    if (!/^[a-fA-F0-9]{64}$/.test(userTxid)) {
      alert("‚ùå Invalid Transaction ID. It must be 64 characters long and contain only letters a‚Äìf and numbers.");
      return;
    }

    fetch('https://formspree.io/f/xvgaawzj', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json'
      },
      body: JSON.stringify({
        email: userEmail,
        message: `New BTC Submission\nEmail: ${userEmail}\nTXID: ${userTxid}`
      })
    });

    document.getElementById('paymentForm').style.display = 'none';
    document.getElementById('paymentSection')?.style.display = 'none';
    document.getElementById('confirmation').style.display = 'block';
    document.getElementById('timerBox').style.display = 'block';
    checkConfirmations(userTxid);
    confirmationInterval = setInterval(() => checkConfirmations(userTxid), 60000);
  });

  function showOrderPopup() {
    const popup = document.getElementById('orderPopup');
    const minutes = Math.floor(Math.random() * 4) + 1;
    document.getElementById('randomMinutes').textContent = minutes;
    popup.style.display = 'block';
    popup.style.opacity = '1';

    setTimeout(() => {
      popup.style.opacity = '0';
    }, 4000);

    setTimeout(() => {
      popup.style.display = 'none';
    }, 5000);
  }

  window.addEventListener('load', () => {
    fetchBTCPrice();
    setTimeout(showOrderPopup, 2000);
  });
</script>

</body>
</html>
