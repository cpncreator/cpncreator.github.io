<script>
  // 1) Make sure the script is loaded
  console.log('âš™ï¸ CPN Creator script loaded');

  // 2) Copy function
  function copyBTC() {
    console.log('âœ‚ï¸ copyBTC() called');
    navigator.clipboard.writeText('bc1qtfxzerwdm0wv6v7akvx0h0ksqvx7ycuhaxqa5y')
      .then(() => {
        console.log('âœ… Address copied');
        alert("Bitcoin address copied to clipboard.");
      })
      .catch(err => {
        console.error('âŒ copy failed:', err);
        alert("Copy failedâ€”see console for details.");
      });
  }

  // 3) Fetch price
  function fetchBTCPrice() {
    console.log('â³ fetchBTCPrice() called');
    const btcAmountEl = document.getElementById('btcAmount');
    const priceUSD    = 700;

    fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd')
      .then(res => {
        console.log('ðŸ” HTTP status:', res.status);
        if (!res.ok) throw new Error(`Status ${res.status}`);
        return res.json();
      })
      .then(data => {
        console.log('âœ… CoinGecko returned:', data);
        const rate   = data.bitcoin.usd;
        const amount = (priceUSD / rate).toFixed(8);
        btcAmountEl.textContent = `â‰ˆ ${amount} BTC`;
      })
      .catch(err => {
        console.error('âŒ Error fetching BTC price:', err);
        btcAmountEl.textContent = 'âš ï¸ Error loading BTC';
      });
  }

  // 4) Wire up page logic after DOM is ready
  document.addEventListener('DOMContentLoaded', () => {
    console.log('ðŸ“¦ DOMContentLoaded');
    fetchBTCPrice();
    // (you can uncomment the next line if you want auto-refresh)
    // setInterval(fetchBTCPrice, 60_000);
  });
</script>
